<!-- <!DOCTYPE html>
<html>
<head>
  <title>CRUD in EJS</title>
</head>
<body>
  <h1>All Categories</h1>
  <ul>
    <% categories.forEach(cat => { %>
      <li>
        <%= cat.name %>
        <form method="POST" action="/delete-category/<%= cat._id %>" style="display:inline;">
          <button type="submit">Delete</button>
        </form>
      </li>
    <% }) %>
  </ul>

  <form method="POST" action="/add-category">
    <input name="name" placeholder="New Category" />
    <button type="submit">Add</button>
  </form>

  <hr>
  <h1>All Subcategories</h1>
  <ul>
<% subcategories.forEach(sub => { %>
  <li>
    <%= sub.name %> 
    (Category: <%= sub.category ? sub.category.name : 'N/A' %>)
    <form method="POST" action="/delete-subcategory/<%= sub._id %>" style="display:inline;">
      <button type="submit">Delete</button>
    </form>
  </li>
<% }); %>
  </ul>
 


  <form method="POST" action="/add-subcategory">
    <input name="name" placeholder="New Subcategory" />
    <select name="categoryId">
      <% categories.forEach(cat => { %>
        <option value="<%= cat._id %>"><%= cat.name %></option>
      <% }) %>
    </select>
    <button type="submit">Add</button>
  </form>

  <hr>

  <h1>All Products</h1>
  <ul>
    <% products.forEach(prod => { %>
      <li>
        <%= prod.name %> - ₹<%= prod.ourPrice %> (MRP ₹<%= prod.mrp %>)
        <br>Category: <%= prod.category.name %> | Subcategory: <%= prod.subcategory.name %>
        <br><%= prod.description %>
        <form method="POST" action="/delete-product/<%= prod._id %>" style="display:inline;">
          <button type="submit">Delete</button>
        </form>
      </li>
    <% }) %>
  </ul>
  
  <form method="POST" action="/add-product">
    <input name="name" placeholder="Product Name" />
    <input name="mrp" placeholder="MRP" />
    <input name="ourPrice" placeholder="Our Price" />
    <textarea name="description" placeholder="Description"></textarea>
    <br>
    <select name="categoryId">
      <% categories.forEach(cat => { %>
        <option value="<%= cat._id %>"><%= cat.name %></option>
      <% }) %>
    </select>
    <select name="subcategoryId">
      <% subcategories.forEach(sub => { %>
        <option value="<%= sub._id %>"><%= sub.name %></option>
      <% }) %>
    </select>
    <button type="submit">Add</button>
  </form>
</body>
</html> -->
<!DOCTYPE html>
<html>
<head>
  <title>CRUD in EJS</title>
</head>
<body>
  <h1>All Categories</h1>
  <ul>
    <% categories.forEach(cat => { %>
      <li>
        <%= cat.name %>
        <form method="POST" action="/delete-category/<%= cat._id %>" style="display:inline;">
          <button type="submit">Delete</button>
        </form>
      </li>
    <% }) %>
  </ul>

  <form method="POST" action="/add-category">
    <input name="name" placeholder="New Category" />
    <button type="submit">Add</button>
  </form>

  <hr>
  <h1>All Subcategories</h1>
  <ul>
<% subcategories.forEach(sub => { %>
  <li>
    <%= sub.name %> 
    (Category: <%= sub.category ? sub.category.name : 'N/A' %>)
    <form method="POST" action="/delete-subcategory/<%= sub._id %>" style="display:inline;">
      <button type="submit">Delete</button>
    </form>
  </li>
<% }); %>
  </ul>

  <form method="POST" action="/add-subcategory">
    <input name="name" placeholder="New Subcategory" />
    <select name="categoryId">
      <% categories.forEach(cat => { %>
        <option value="<%= cat._id %>"><%= cat.name %></option>
      <% }) %>
    </select>
    <button type="submit">Add</button>
  </form>

  <hr>
  <h1>All Products</h1>
  <% products.forEach(prod => { %>
    <form method="POST" action="/update-product/<%= prod._id %>">
      <input name="name" value="<%= prod.name %>" />
      <input name="mrp" value="<%= prod.mrp %>" />
      <input name="ourPrice" value="<%= prod.ourPrice %>" />
      <textarea name="description"><%= prod.description %></textarea>
      <br>
      <select name="categoryId">
        <% categories.forEach(cat => { %>
          <option value="<%= cat._id %>" <%= (prod.category && cat._id.toString() === prod.category._id.toString()) ? 'selected' : '' %>><%= cat.name %></option>
        <% }) %>
      </select>
      <select name="subcategoryId">
        <% subcategories.forEach(sub => { %>
          <option value="<%= sub._id %>" <%= (prod.subcategory && sub._id.toString() === prod.subcategory._id.toString()) ? 'selected' : '' %>><%= sub.name %></option>
        <% }) %>
      </select>
      <button type="submit">Update</button>
    </form>
    <form method="POST" action="/delete-product/<%= prod._id %>" style="display:inline;">
      <button type="submit">Delete</button>
    </form>
    <hr>
  <% }) %>

  <form method="POST" action="/add-product">
    <input name="name" placeholder="Product Name" />
    <input name="mrp" placeholder="MRP" />
    <input name="ourPrice" placeholder="Our Price" />
    <textarea name="description" placeholder="Description"></textarea>
    <br>
    <select name="categoryId">
      <% categories.forEach(cat => { %>
        <option value="<%= cat._id %>"><%= cat.name %></option>
      <% }) %>
    </select>
    <select name="subcategoryId">
      <% subcategories.forEach(sub => { %>
        <option value="<%= sub._id %>"><%= sub.name %></option>
      <% }) %>
    </select>
    <button type="submit">Add</button>
  </form>
</body>
</html>
